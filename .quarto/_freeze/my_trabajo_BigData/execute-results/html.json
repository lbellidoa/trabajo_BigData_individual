{
  "hash": "be57c2f0a7898a73484a95ed5a8a9831",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"El mejor libro\"\ndescription: |\n  Basandonos en las reviews en la aplicacion Goodreads\nauthor:\n  - name: Lucía Bellido\n    affiliation: Universitat de València\n    affiliation-url: https://www.uv.es\ndate: 2026-01-07                           #--\ncategories: [trabajo BigData, libros]   #--\nimage: \"./imagenes/descarga.png\"\ntitle-block-banner: true #- {true, false, \"green\",\"#AA0000\"}\ntitle-block-banner-color: \"#FFFFFF\"    #-\"#FFFFFF\" \ntoc-depth: 3\nsmooth-scroll: true\nformat: \n  html:\n    #backgroundcolor: \"#F1F3F4\"\n    #embed-resources: true\n    link-external-newwindow: true\n    #css: assets/my_css_file.css   #- CUIDADO!!!!\ncode-tools: true\ncode-link: true\n---\n\n## Introducción \n\nPara este trabajo vamos a estar utilizando datos sobre libros en Goodreads y sus notas, estos se pueden sacar de [aquí](https://datahub.io/@gradedSystem/goodreads_dataset). También utilizaremos datos sobre el número de hablantes de cada idioma que se pueden encontrar [aquí](https://www.kaggle.com/datasets/narmelan/100-most-spoken-languages-around-the-world?resource=download)\n\nLos datos se pueden cargar en la memoria de de R/RStudio de esta forma:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(readr)\ngoodreads <- read_csv(\"data/goodreads.csv\")\nhablantes <- read_csv(\"data/Top 100 Languages.csv\")\n```\n:::\n\n\nY descargamos la biblioteca:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(gt)\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(viridis)\nlibrary(hrbrthemes)\nlibrary(highcharter)\n```\n:::\n\n\n---\n\n## ¿Qué libros le gusta a la gente?\n\nEmpezaremos con un gráfico de burbujas para observar qué libros han tenido más éxito, obteniendo mayores notas medias.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nburbujas <- goodreads %>% \n  mutate (anio = str_extract(publication_date, \"\\\\d{4}$\")) %>% \n  drop_na () %>% \n  arrange (desc(average_rating)) %>%\n  filter (average_rating >= 4.65)\n\np <- burbujas %>%\n  mutate (language_code = factor(language_code, levels = unique(language_code))) %>%\n  mutate (text = paste(\"Libro: \", title,\n                       \"\\nIdioma: \", language_code, \n                       \"\\nNota: \", average_rating, \n                       \"\\nAño: \", anio, \n                       \"\\nNúmero de votos: \", \n                       ratings_count, sep=\"\")) %>%\n  ggplot (aes(x = anio, y = average_rating, size = ratings_count, color = language_code, text=text)) +\n    geom_point (alpha = 0.7) +\n    scale_size (range = c(1.4, 19), name = \"Nº votos\") +\n    scale_color_viridis (discrete = TRUE, guide = FALSE) +\n    theme_ipsum () +\n    theme (legend.position = \"none\") +\n  labs (title = \"Libros con mejor media\",\n        x = \"Año\", y = \"Nota media\")\n\npp <- ggplotly (p, tooltip=\"text\") \n\npp\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-a82c7bfa671ccafb8757\" style=\"width:95%;height:1500px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a82c7bfa671ccafb8757\">{\"x\":{\"data\":[{\"x\":[16,9,12,12,16,12,11,2,12,12,11,15,14,15,14,13,7,15,14,17,6,10,13,14,12,13,5,15,8,15,4,14,13,15],\"y\":[5,5,5,5,5,5,5,5,5,5,5,5,4.9100000000000001,4.8300000000000001,4.8200000000000003,4.7800000000000002,4.7599999999999998,4.7300000000000004,4.7300000000000004,4.7199999999999998,4.7199999999999998,4.71,4.7000000000000002,4.7000000000000002,4.6900000000000004,4.6900000000000004,4.6900000000000004,4.6699999999999999,4.6699999999999999,4.6699999999999999,4.6699999999999999,4.6699999999999999,4.6699999999999999,4.6500000000000004],\"text\":[\"Libro: His Princess Devotional: A Royal Encounter With Your King<br />Idioma: eng<br />Nota: 5<br />Año: 2007<br />Número de votos: 2\",\"Libro: The American Campaign: U.S. Presidential Campaigns and the National Vote<br />Idioma: eng<br />Nota: 5<br />Año: 2000<br />Número de votos: 0\",\"Libro: The Irish Anatomist: A Study of Flann O'Brien<br />Idioma: eng<br />Nota: 5<br />Año: 2003<br />Número de votos: 1\",\"Libro: Tyrannosaurus Wrecks (Stanley  #1)<br />Idioma: eng<br />Nota: 5<br />Año: 2003<br />Número de votos: 2\",\"Libro: Oliver Wendell Holmes in Paris: Medicine  Theology  and the Autocrat of the Breakfast Table<br />Idioma: eng<br />Nota: 5<br />Año: 2007<br />Número de votos: 1\",\"Libro: Fanning the Flame: Bible  Cross  and Mission<br />Idioma: eng<br />Nota: 5<br />Año: 2003<br />Número de votos: 1\",\"Libro: The New Big Book of America<br />Idioma: eng<br />Nota: 5<br />Año: 2002<br />Número de votos: 2\",\"Libro: Taxation of Mineral Rents<br />Idioma: eng<br />Nota: 5<br />Año: 1983<br />Número de votos: 1\",\"Libro: Zone of the Enders: The 2nd Runner Official Strategy Guide<br />Idioma: eng<br />Nota: 5<br />Año: 2003<br />Número de votos: 2\",\"Libro: Middlesex Borough (Images of America: New Jersey)<br />Idioma: eng<br />Nota: 5<br />Año: 2003<br />Número de votos: 2\",\"Libro: Literature Circle Guide: Bridge to Terabithia: Everything You Need For Successful Literature Circles That Get Kids Thinking  Talking  Writing—and Loving Literature<br />Idioma: eng<br />Nota: 5<br />Año: 2002<br />Número de votos: 4\",\"Libro: Willem de Kooning: Late Paintings<br />Idioma: eng<br />Nota: 5<br />Año: 2006<br />Número de votos: 1\",\"Libro: Existential Meditation<br />Idioma: eng<br />Nota: 4.91<br />Año: 2005<br />Número de votos: 11\",\"Libro: Corvette<br />Idioma: eng<br />Nota: 4.83<br />Año: 2006<br />Número de votos: 6\",\"Libro: The Complete Calvin and Hobbes<br />Idioma: eng<br />Nota: 4.82<br />Año: 2005<br />Número de votos: 32213\",\"Libro: Harry Potter Boxed Set  Books 1-5 (Harry Potter  #1-5)<br />Idioma: eng<br />Nota: 4.78<br />Año: 2004<br />Número de votos: 41428\",\"Libro: It's a Magical World (Calvin and Hobbes  #11)<br />Idioma: eng<br />Nota: 4.76<br />Año: 1996<br />Número de votos: 23875\",\"Libro: Early Color<br />Idioma: eng<br />Nota: 4.73<br />Año: 2006<br />Número de votos: 144\",\"Libro: Harry Potter Collection (Harry Potter  #1-6)<br />Idioma: eng<br />Nota: 4.73<br />Año: 2005<br />Número de votos: 28242\",\"Libro: The Beatles' Story on Capitol Records  Part Two: The Albums<br />Idioma: eng<br />Nota: 4.72<br />Año: 2010<br />Número de votos: 29\",\"Libro: Homicidal Psycho Jungle Cat (Calvin and Hobbes #9)<br />Idioma: eng<br />Nota: 4.72<br />Año: 1994<br />Número de votos: 15365\",\"Libro: Calvin and Hobbes: Sunday Pages 1985-1995: An Exhibition Catalogue<br />Idioma: eng<br />Nota: 4.71<br />Año: 2001<br />Número de votos: 3613\",\"Libro: The Complete Aubrey/Maturin Novels (5 Volumes)<br />Idioma: eng<br />Nota: 4.7<br />Año: 2004<br />Número de votos: 1338\",\"Libro: The 5 Love Languages / The 5 Love Languages Journal<br />Idioma: eng<br />Nota: 4.7<br />Año: 2005<br />Número de votos: 22\",\"Libro: Cook's Illustrated 2003 (Cook's Illustrated Annuals)<br />Idioma: eng<br />Nota: 4.69<br />Año: 2003<br />Número de votos: 26\",\"Libro: A Wife After God's Own Heart Growth and Study Guide<br />Idioma: eng<br />Nota: 4.69<br />Año: 2004<br />Número de votos: 9\",\"Libro: The Days Are Just Packed<br />Idioma: eng<br />Nota: 4.69<br />Año: 1993<br />Número de votos: 20308\",\"Libro: Getting a Grip on the Basics: Building a Firm Foundation for the Victorious Christian Life<br />Idioma: eng<br />Nota: 4.67<br />Año: 2006<br />Número de votos: 9\",\"Libro: Restless Till We Rest in You: 60 Reflections from the Writings of St. Augustine (Saints Speak Today)<br />Idioma: eng<br />Nota: 4.67<br />Año: 1998<br />Número de votos: 6\",\"Libro: Falling Angels (Luc Actar #1)<br />Idioma: eng<br />Nota: 4.67<br />Año: 2006<br />Número de votos: 1\",\"Libro: Bill Buzz<br />Idioma: eng<br />Nota: 4.67<br />Año: 1989<br />Número de votos: 2\",\"Libro: The Life and Times of Scrooge McDuck<br />Idioma: eng<br />Nota: 4.67<br />Año: 2005<br />Número de votos: 2467\",\"Libro: Empire 2.0: A Modest Proposal for a United States of the West (Terra Nova)<br />Idioma: eng<br />Nota: 4.67<br />Año: 2004<br />Número de votos: 3\",\"Libro: The Absolute Sandman  Volume One<br />Idioma: eng<br />Nota: 4.65<br />Año: 2006<br />Número de votos: 15640\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(68,1,84,1)\",\"opacity\":0.69999999999999996,\"size\":[5.7535260854456958,5.2913385826771648,5.6181545000644686,5.7535260854456958,5.6181545000644686,5.6181545000644686,5.7535260854456958,5.6181545000644686,5.7535260854456958,5.7535260854456958,5.9449704174517723,5.6181545000644686,6.375264356166638,6.0918708200956395,63.948195339481366,71.811023622047244,55.78942143839263,9.2131295913248081,60.213917908754901,7.0512961594026509,45.802013877883432,24.93566677831388,17.245834200711791,6.8242411121517259,6.9577793227877534,6.2717863348390761,51.864613531538886,6.2717863348390761,6.0918708200956395,5.6181545000644686,5.7535260854456958,21.523926928254028,5.8574003563142076,46.162932507241734],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(68,1,84,1)\"}},\"hoveron\":\"points\",\"name\":\"eng\",\"legendgroup\":\"eng\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[3],\"y\":[5],\"text\":\"Libro: Delwau Duon: Peintiadau Nicholas Evans = Symphonies in Black: The Paintings of Nicholas Evans<br />Idioma: wel<br />Nota: 5<br />Año: 1987<br />Número de votos: 1\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(65,68,135,1)\",\"opacity\":0.69999999999999996,\"size\":5.6181545000644686,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(65,68,135,1)\"}},\"hoveron\":\"points\",\"name\":\"wel\",\"legendgroup\":\"wel\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1],\"y\":[5],\"text\":\"Libro: Comoediae 1: Acharenses/Equites/Nubes/Vespae/Pax/Aves<br />Idioma: grc<br />Nota: 5<br />Año: 1922<br />Número de votos: 0\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(42,120,142,1)\",\"opacity\":0.69999999999999996,\"size\":5.2913385826771648,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(42,120,142,1)\"}},\"hoveron\":\"points\",\"name\":\"grc\",\"legendgroup\":\"grc\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[10,12],\"y\":[4.8799999999999999,4.6900000000000004],\"text\":[\"Libro: Little Big Book for God's Children<br />Idioma: en-US<br />Nota: 4.88<br />Año: 2001<br />Número de votos: 8\",\"Libro: The Sibley Field Guide to Birds of Western North America<br />Idioma: en-US<br />Nota: 4.69<br />Año: 2003<br />Número de votos: 730\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(34,168,132,1)\",\"opacity\":0.69999999999999996,\"size\":[6.215713588214224,14.121418424678852],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(34,168,132,1)\"}},\"hoveron\":\"points\",\"name\":\"en-US\",\"legendgroup\":\"en-US\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[6],\"y\":[4.7800000000000002],\"text\":\"Libro: Wissenschaft der Logik: Die Lehre Vom Begriff (1816)<br />Idioma: ger<br />Nota: 4.78<br />Año: 1994<br />Número de votos: 0\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(122,209,81,1)\",\"opacity\":0.69999999999999996,\"size\":5.2913385826771648,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(122,209,81,1)\"}},\"hoveron\":\"points\",\"name\":\"ger\",\"legendgroup\":\"ger\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[12],\"y\":[4.7199999999999998],\"text\":\"Libro: Elliott Erwitt: Snaps<br />Idioma: en-GB<br />Nota: 4.72<br />Año: 2003<br />Número de votos: 102\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(253,231,37,1)\",\"opacity\":0.69999999999999996,\"size\":8.5920175542655706,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(253,231,37,1)\"}},\"hoveron\":\"points\",\"name\":\"en-GB\",\"legendgroup\":\"en-GB\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":79.76089663760898,\"r\":39.850560398505614,\"b\":70.900788709007898,\"l\":78.538812785388146},\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"title\":{\"text\":\"<b> Libros con mejor media <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":23.910336239103366},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,17.600000000000001],\"tickmode\":\"array\",\"ticktext\":[\"1922\",\"1983\",\"1987\",\"1989\",\"1993\",\"1994\",\"1996\",\"1998\",\"2000\",\"2001\",\"2002\",\"2003\",\"2004\",\"2005\",\"2006\",\"2007\",\"2010\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],\"categoryorder\":\"array\",\"categoryarray\":[\"1922\",\"1983\",\"1987\",\"1989\",\"1993\",\"1994\",\"1996\",\"1998\",\"2000\",\"2001\",\"2002\",\"2003\",\"2004\",\"2005\",\"2006\",\"2007\",\"2010\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Año\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[4.6325000000000003,5.0175000000000001],\"tickmode\":\"array\",\"ticktext\":[\"4.7\",\"4.8\",\"4.9\",\"5.0\"],\"tickvals\":[4.7000000000000002,4.8000000000000007,4.9000000000000004,5.0000000000000009],\"categoryorder\":\"array\",\"categoryarray\":[\"4.7\",\"4.8\",\"4.9\",\"5.0\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Nota media\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":12.220838522208389}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"416433641f66\":{\"x\":{},\"y\":{},\"size\":{},\"colour\":{},\"text\":{},\"type\":\"scatter\"}},\"cur_data\":\"416433641f66\",\"visdat\":{\"416433641f66\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nCodigo inspirado en [este](https://r-graph-gallery.com/bubble_chart_interactive_ggplotly.html).\n\nComo se puede observar, muchos libros con una puntuación de 5 sobre 5 tienen muy pocas reviews, por lo que vamos a descartarlos y poner un mínimo de 10.000  reviews para elaborar un top 10 más preciso. También eliminaremos las sagas para centrarnos únicamente en libros individuales.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntop_libros <- goodreads %>% \n  filter (ratings_count >= 10000) %>% \n  filter (!str_detect(title, regex(\"\\\\bset\\\\b\", ignore_case = TRUE))) %>% \n  filter (!str_detect(title, regex(\"\\\\bcollection\\\\b\", ignore_case = TRUE))) %>% \n  select (title, authors, average_rating) %>% \n  arrange (desc(average_rating)) %>%\n  head(10)\n\nDT::datatable(top_libros)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-2aa16ebe005476eb53c4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2aa16ebe005476eb53c4\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"The Complete Calvin and Hobbes\",\"It's a Magical World (Calvin and Hobbes  #11)\",\"Homicidal Psycho Jungle Cat (Calvin and Hobbes #9)\",\"The Days Are Just Packed\",\"The Absolute Sandman  Volume One\",\"The Calvin and Hobbes Tenth Anniversary Book\",\"The Lord of the Rings: The Art of the Fellowship of the Ring\",\"Fullmetal Alchemist  Vol. 8 (Fullmetal Alchemist  #8)\",\"Harry Potter and the Half-Blood Prince (Harry Potter  #6)\",\"Fullmetal Alchemist  Vol. 5 (Fullmetal Alchemist  #5)\"],[\"Bill Watterson\",\"Bill Watterson\",\"Bill Watterson\",\"Bill Watterson\",\"Neil Gaiman/Mike Dringenberg/Chris Bachalo/Michael Zulli/Kelly Jones/Charles Vess/Colleen Doran/Malcolm Jones III/Steve Parkhouse/Daniel Vozzo/Lee Loughridge/Steve Oliff/Todd Klein/Dave McKean/Sam Kieth\",\"Bill Watterson\",\"Gary Russell\",\"Hiromu Arakawa/Akira Watanabe\",\"J.K. Rowling/Mary GrandPré\",\"Hiromu Arakawa/Akira Watanabe\"],[4.82,4.76,4.72,4.69,4.65,4.63,4.59,4.57,4.57,4.56]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>title<\\/th>\\n      <th>authors<\\/th>\\n      <th>average_rating<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":3},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"title\",\"targets\":1},{\"name\":\"authors\",\"targets\":2},{\"name\":\"average_rating\",\"targets\":3}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nPodemos observar que la saga \"Calvin and Hobbes\" de Bill Watterson tiene un gran éxito en Goodreads y que la mayoría de libros en el top son cómics o mangas. Además, aparecen sagas muy conocidas como \"Harry Potter\" y \"El señor de los anillos\".\n\n---\n\n## ¿Quién debería escribir nuestro libro?\n\nPara continuar formando el mejor libro, vamos a ver qué autores tienen mejor nota media filtrando también con más de 10.000 reviews y que sean libros individuales.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntop_autores <- goodreads %>% \n  filter (ratings_count >= 10000) %>% \n  filter (!str_detect(title, regex(\"\\\\bset\\\\b\", ignore_case = TRUE))) %>% \n  filter (!str_detect(title, regex(\"\\\\bcollection\\\\b\", ignore_case = TRUE))) %>% \n  group_by (authors) %>% \n  summarise (nota_media = weighted.mean(average_rating, w = ratings_count)) %>% \n  arrange (desc(nota_media)) %>%\n  head (10) %>% \n  mutate (autores = str_trunc(authors, 20)) %>%\n  ungroup ()\n\np2 <- ggplot (top_autores, aes(x = nota_media, y = reorder(autores, nota_media))) + \n  geom_col (fill = \"#7831a2\") +\n  coord_cartesian (xlim = c(4, 5)) +\n  labs (title = \"Autores con mejor media\", \n        x = \"Nota media\", y = \"Autores\")\n\np2\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=95%}\n:::\n:::\n\n\nSe puede observar, como se esperaba al ver el top 10 de libros, que el autor con mejor nota media es Bill Watterson. Aunque también podemos ver a Neil Gaiman en tres posiciones diferentes del top, al tratarse de él junto a muchos otros autores, preferimos quedarnos con B. Watterson para que se trate únicamente de un autor.\n\n---\n\n## ¿Cuántas páginas debe tener nuestro libro?\n\nAhora, vamos a ver cómo de largo tiene que ser nuestro libro basándonos en las reviews de la gente.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np3 <- goodreads %>% \n  mutate (rang_pag = round(num_pages / 25) * 25) %>% \n  group_by (rang_pag) %>% \n  summarise (notita = weighted.mean(average_rating, w = ratings_count)) %>% \n  ggplot (aes(x = rang_pag, y = notita)) +\n  geom_area (fill = \"#7831a2\") + \n  coord_cartesian (xlim = c(0, 1500), ylim = c(3, 5)) +\n  labs (title = \"Nota media por cada 50 páginas\",\n       x = \"Número de páginas\", y = \"Nota Media\")\n\np3\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=95%}\n:::\n:::\n\n\nCodigo inspirado de [aquí](https://r-graph-gallery.com).\n\nPodemos ver que el rango de mejores reviews está entorno a las 1.300 páginas por lo que nuestro libro tendrá que situarse en ese rango.\n\n---\n\n## ¿En qué idioma debería estar nuestro libro?\n\nPor último, queremos echar un vistazo a qué idiomas reciben mejores reviews para decidir en qué idioma debería escribirse nuestro libro para que sea el mejor. \nPara ello, realizaremos un gráfico de violín unificando todos los diferentes códigos de inglés para que cuenten como uno solo y filtrando los diez idiomas con mejor nota media.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntop_idioma <- goodreads %>% \n  mutate (language_code = fct_collapse(language_code,\n    \"eng\" = c(\"eng\", \"en-GB\", \"en-US\", \"en-CA\", \"enm\"))) %>% \n  group_by (language_code) %>% \n  summarise (media = weighted.mean(average_rating, w = ratings_count)) %>% \n  arrange (desc(media)) %>%\n  head (10) %>% \n  pull(language_code) \n\np4 <- goodreads %>% \n  mutate (language_code = fct_collapse(language_code,\n    \"eng\" = c(\"eng\", \"en-GB\", \"en-US\", \"en-CA\", \"enm\"))) %>% \n  filter (language_code %in% top_idioma) %>% \n  ggplot (aes(x = reorder(language_code, -average_rating), y = average_rating)) + \n  geom_violin (fill = \"#7831a2\") +\n  coord_cartesian (ylim = c(3, 5)) +\n  labs (title = \"Nota media por idiomas\",\n       x = \"Idioma\", y = \"Nota Media\")\n\np4\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=95%}\n:::\n:::\n\n\nCodigo inspirado de [aquí](https://r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html).\n\nSe puede observar que el idioma con mejor nota media es el chino. Sin embargo, para comprobar si realmente este idioma tiene tantos lectores potenciales, analizaremos cuáles son los idiomas más hablados.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntop_hablantes <- hablantes %>% \n  mutate (porcentaje = ((`Total Speakers`)/sum(`Total Speakers`))*100) %>% \n  select (Language, porcentaje) %>% \n  arrange (desc(porcentaje)) %>%\n  head (10) \n\nhchart(top_hablantes, \"pie\", hcaes(x = Language, y = porcentaje))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"highchart html-widget html-fill-item\" id=\"htmlwidget-e82c31fc4be114943a8c\" style=\"width:95%;height:1500px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e82c31fc4be114943a8c\">{\"x\":{\"hc_opts\":{\"chart\":{\"reflow\":true},\"title\":{\"text\":null},\"yAxis\":{\"title\":{\"text\":\"porcentaje\"},\"type\":\"linear\"},\"credits\":{\"enabled\":false},\"exporting\":{\"enabled\":false},\"boost\":{\"enabled\":false},\"plotOptions\":{\"series\":{\"label\":{\"enabled\":false},\"turboThreshold\":0,\"showInLegend\":false},\"treemap\":{\"layoutAlgorithm\":\"squarified\"},\"scatter\":{\"marker\":{\"symbol\":\"circle\"}}},\"series\":[{\"group\":\"group\",\"data\":[{\"Language\":\"English\",\"porcentaje\":13.68092733665274,\"y\":13.68092733665274,\"name\":\"English\"},{\"Language\":\"Mandarin Chinese\",\"porcentaje\":13.49039826586085,\"y\":13.49039826586085,\"name\":\"Mandarin Chinese\"},{\"Language\":\"Hindi\",\"porcentaje\":7.435997799076098,\"y\":7.435997799076098,\"name\":\"Hindi\"},{\"Language\":\"Spanish\",\"porcentaje\":6.455690038060196,\"y\":6.455690038060196,\"name\":\"Spanish\"},{\"Language\":\"French\",\"porcentaje\":3.380727779390268,\"y\":3.380727779390268,\"name\":\"French\"},{\"Language\":\"Standard Arabic\",\"porcentaje\":3.310264460175818,\"y\":3.310264460175818,\"name\":\"Standard Arabic\"},{\"Language\":\"Bengali\",\"porcentaje\":3.202166731015291,\"y\":3.202166731015291,\"name\":\"Bengali\"},{\"Language\":\"Russian\",\"porcentaje\":3.119833251245616,\"y\":3.119833251245616,\"name\":\"Russian\"},{\"Language\":\"Portuguese\",\"porcentaje\":2.829157667147402,\"y\":2.829157667147402,\"name\":\"Portuguese\"},{\"Language\":\"Indonesian\",\"porcentaje\":2.401041984873143,\"y\":2.401041984873143,\"name\":\"Indonesian\"}],\"type\":\"pie\"}],\"xAxis\":{\"type\":\"category\",\"title\":{\"text\":\"Language\"},\"categories\":null}},\"theme\":{\"chart\":{\"backgroundColor\":\"transparent\"},\"colors\":[\"#7cb5ec\",\"#434348\",\"#90ed7d\",\"#f7a35c\",\"#8085e9\",\"#f15c80\",\"#e4d354\",\"#2b908f\",\"#f45b5b\",\"#91e8e1\"]},\"conf_opts\":{\"global\":{\"Date\":null,\"VMLRadialGradientURL\":\"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png\",\"canvasToolsURL\":\"http =//code.highcharts.com/list(version)/modules/canvas-tools.js\",\"getTimezoneOffset\":null,\"timezoneOffset\":0,\"useUTC\":true},\"lang\":{\"contextButtonTitle\":\"Chart context menu\",\"decimalPoint\":\".\",\"downloadCSV\":\"Download CSV\",\"downloadJPEG\":\"Download JPEG image\",\"downloadPDF\":\"Download PDF document\",\"downloadPNG\":\"Download PNG image\",\"downloadSVG\":\"Download SVG vector image\",\"downloadXLS\":\"Download XLS\",\"drillUpText\":\"◁ Back to {series.name}\",\"exitFullscreen\":\"Exit from full screen\",\"exportData\":{\"annotationHeader\":\"Annotations\",\"categoryDatetimeHeader\":\"DateTime\",\"categoryHeader\":\"Category\"},\"hideData\":\"Hide data table\",\"invalidDate\":null,\"loading\":\"Loading...\",\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"noData\":\"No data to display\",\"numericSymbolMagnitude\":1000,\"numericSymbols\":[\"k\",\"M\",\"G\",\"T\",\"P\",\"E\"],\"printChart\":\"Print chart\",\"resetZoom\":\"Reset zoom\",\"resetZoomTitle\":\"Reset zoom level 1:1\",\"shortMonths\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"shortWeekdays\":[\"Sat\",\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\"],\"thousandsSep\":\" \",\"viewData\":\"View data table\",\"viewFullscreen\":\"View in full screen\",\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]}},\"type\":\"chart\",\"fonts\":[],\"debug\":false},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nEste gráfico nos muestra que el chino es el segundo idioma más hablado, con muy poca diferencia respecto al primer puesto, que corresponde al inglés. Por lo tanto, escribiendo el libro en chino sí podríamos llegar a una audiencia muy amplia.\n\nDe esta manera, ¡¡hemos conseguido definir cómo debería ser el **mejor libro del mundo**!! \nEste debería ser un cómic o manga escrito por Bill Watterson, en chino, y de unas 1.300 páginas. \n\n----------------------\n\n¡Y hasta aquí mi trabajo de Big Data, espero que os haya gustado!\n\n![Una foto mía](./imagenes/descarga2.jpg)\n",
    "supporting": [
      "my_trabajo_BigData_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/plotly-binding-4.11.0/plotly.js\"></script>\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.34.0/datatables.js\"></script>\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<script src=\"site_libs/proj4js-2.3.15/proj4.js\"></script>\n<link href=\"site_libs/highcharts-9.3.1/css/motion.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/highcharts-9.3.1/highcharts.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/highcharts-3d.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/highcharts-more.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/stock.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/map.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/data.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/exporting.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/offline-exporting.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/drilldown.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/item-series.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/overlapping-datalabels.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/annotations.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/export-data.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/funnel.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/heatmap.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/treemap.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/sankey.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/dependency-wheel.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/organization.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/solid-gauge.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/streamgraph.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/sunburst.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/vector.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/wordcloud.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/xrange.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/tilemap.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/venn.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/gantt.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/timeline.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/parallel-coordinates.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/bullet.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/coloraxis.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/dumbbell.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/lollipop.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/series-label.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/plugins/motion.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/custom/reset.js\"></script>\n<script src=\"site_libs/highcharts-9.3.1/modules/boost.js\"></script>\n<script src=\"site_libs/highchart-binding-0.9.4/highchart.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}